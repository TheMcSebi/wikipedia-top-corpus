Factorial
In mathematics, the factorial of a non-negative integer $MATH$, denoted by $MATH$, is the product of all positive integers less than or equal to $MATH$. The factorial of $MATH$ also equals the product of $MATH$ with the next smaller factorial:
For example,
The value of 0! is 1, according to the convention for an empty product.
Factorials have been discovered in several ancient cultures, notably in Indian mathematics in the canonical works of Jain literature, and by Jewish mystics in the Talmudic book Sefer Yetzirah. The factorial operation is encountered in many areas of mathematics, notably in combinatorics, where its most basic use counts the possible distinct sequences – the permutations – of $MATH$ distinct objects: there are $MATH$. In mathematical analysis, factorials are used in power series for the exponential function and other functions, and they also have applications in algebra, number theory, probability theory, and computer science.
Much of the mathematics of the factorial function was developed beginning in the late 18th and early 19th centuries.
Stirling's approximation provides an accurate approximation to the factorial of large numbers, showing that it grows more quickly than exponential growth. Legendre's formula describes the exponents of the prime numbers in a prime factorization of the factorials, and can be used to count the trailing zeros of the factorials. Daniel Bernoulli and Leonhard Euler interpolated the factorial function to a continuous function of complex numbers, except at the negative integers, the (offset) gamma function.
Many other notable functions and number sequences are closely related to the factorials, including the binomial coefficients, double factorials, falling factorials, primorials, and subfactorials. Implementations of the factorial function are commonly used as an example of different computer programming styles, and are included in scientific calculators and scientific computing software libraries. Although directly computing large factorials using the product formula or recurrence is not efficient, faster algorithms are known, matching to within a constant factor the time for fast multiplication algorithms for numbers with the same number of digits.
History
The concept of factorials has arisen independently in many cultures:
From the late 15th century onward, factorials became the subject of study by western mathematicians. In a 1494 treatise, Italian mathematician Luca Pacioli calculated factorials up to 11!, in connection with a problem of dining table arrangements. Christopher Clavius discussed factorials in a 1603 commentary on the work of Johannes de Sacrobosco, and in the 1640s, French polymath Marin Mersenne published large (but not entirely correct) tables of factorials, up to 64!, based on the work of Clavius. The power series for the exponential function, with the reciprocals of factorials for its coefficients, was first formulated in 1676 by Isaac Newton in a letter to Gottfried Wilhelm Leibniz. Other important works of early European mathematics on factorials include extensive coverage in a 1685 treatise by John Wallis, a study of their approximate values for large values of $MATH$ by Abraham de Moivre in 1721, a 1729 letter from James Stirling to de Moivre stating what became known as Stirling's approximation, and work at the same time by Daniel Bernoulli and Leonhard Euler formulating the continuous extension of the factorial function to the gamma function. Adrien-Marie Legendre included Legendre's formula, describing the exponents in the factorization of factorials into prime powers, in an 1808 text on number theory.
The notation $MATH$ for factorials was introduced by the French mathematician Christian Kramp in 1808. Many other notations have also been used. Another later notation, in which the argument of the factorial was half-enclosed by the left and bottom sides of a box, was popular for some time in Britain and America but fell out of use, perhaps because it is difficult to typeset. The word "factorial" (originally French: factorielle) was first used in 1800 by Louis François Antoine Arbogast, in the first work on Faà di Bruno's formula, but referring to a more general concept of products of arithmetic progressions. The "factors" that this name refers to are the terms of the product formula for the factorial.
Definition
The factorial function of a positive integer $MATH$ is defined by the product of all positive integers not greater than $MATH$
This may be written more concisely in product notation as
If this product formula is changed to keep all but the last term, it would define a product of the same form, for a smaller factorial. This leads to a recurrence relation, according to which each value of the factorial function can be obtained by multiplying the previous value by $MATH$:
For example, $MATH$.
Factorial of zero
The factorial of $MATH$ is $MATH$, or in symbols, $MATH$. There are several motivations for this definition:
Applications

The earliest uses of the factorial function involve counting permutations: there are $MATH$ different ways of arranging $MATH$ distinct objects into a sequence. Factorials appear more broadly in many formulas in combinatorics, to account for different orderings of objects. For instance the binomial coefficients $MATH$ count the $MATH$-element combinations (subsets of $MATH$ elements) from a set with $MATH$ elements, and can be computed from factorials using the formula
 The Stirling numbers of the first kind sum to the factorials, and count the permutations of $MATH$ grouped into subsets with the same numbers of cycles. Another combinatorial application is in counting derangements, permutations that do not leave any element in its original position; the number of derangements of $MATH$ items is the nearest integer to $MATH$.

In algebra, the factorials arise through the binomial theorem, which uses binomial coefficients to expand powers of sums. They also occur in the coefficients used to relate certain families of polynomials to each other, for instance in Newton's identities for symmetric polynomials. Their use in counting permutations can also be restated algebraically: the factorials are the orders of finite symmetric groups. In calculus, factorials occur in Faà di Bruno's formula for chaining higher derivatives. In mathematical analysis, factorials frequently appear in the denominators of power series, most notably in the series for the exponential function,

and in the coefficients of other Taylor series (in particular those of the trigonometric and hyperbolic functions), where they cancel factors of $MATH$ coming from the $MATH$th derivative of $MATH$. This usage of factorials in power series connects back to analytic combinatorics through the exponential generating function, which for a combinatorial class with $MATH$ elements of size $MATH$ is defined as the power series
In number theory, the most salient property of factorials is the divisibility of $MATH$ by all positive integers up to $MATH$, described more precisely for prime factors by Legendre's formula. It follows that arbitrarily large prime numbers can be found as the prime factors of the numbers
$MATH$, leading to a proof of Euclid's theorem that the number of primes is infinite. When $MATH$ is itself prime it is called a factorial prime; relatedly, Brocard's problem, also posed by Srinivasa Ramanujan, concerns the existence of square numbers of the form $MATH$. In contrast, the numbers $MATH$ must all be composite, proving the existence of arbitrarily large prime gaps. An elementary proof of Bertrand's postulate on the existence of a prime in any interval of the form $MATH$, one of the first results of Paul Erdős, was based on the divisibility properties of factorials. The factorial number system is a mixed radix notation for numbers in which the place values of each digit are factorials.
Factorials are used extensively in probability theory, for instance in the Poisson distribution and in the probabilities of random permutations. In computer science, beyond appearing in the analysis of brute-force searches over permutations, factorials arise in the lower bound of $MATH$ on the number of comparisons needed to comparison sort a set of $MATH$ items, and in the analysis of chained hash tables, where the distribution of keys per cell can be accurately approximated by a Poisson distribution. Moreover, factorials naturally appear in formulae from quantum and statistical physics, where one often considers all the possible permutations of a set of particles. In statistical mechanics, calculations of entropy such as Boltzmann's entropy formula or the Sackur–Tetrode equation must correct the count of microstates by dividing by the factorials of the numbers of each type of indistinguishable particle to avoid the Gibbs paradox. Quantum physics provides the underlying reason for why these corrections are necessary.
Properties
Growth and approximation
As a function of $MATH$, the factorial has faster than exponential growth, but grows more slowly than a double exponential function. Its growth rate is similar to $MATH$, but slower by an exponential factor. One way of approaching this result is by taking the natural logarithm of the factorial, which turns its product formula into a sum, and then estimating the sum by an integral:
Exponentiating the result (and ignoring the negligible $MATH$ term) approximates $MATH$ as $MATH$.
More carefully bounding the sum both above and below by an integral, using the trapezoid rule, shows that this estimate needs a correction factor proportional to $MATH$. The constant of proportionality for this correction can be found from the Wallis product, which expresses $MATH$ as a limiting ratio of factorials and powers of two. The result of these corrections is Stirling's approximation:
Here, the $MATH$ symbol means that, as $MATH$ goes to infinity, the ratio between the left and right sides approaches one in the limit.
Stirling's formula provides the first term in an asymptotic series that becomes even more accurate when taken to greater numbers of terms:
An alternative version uses only odd exponents in the correction terms:
Many other variations of these formulas have also been developed, by Srinivasa Ramanujan, Bill Gosper, and others.
The binary logarithm of the factorial, used to analyze comparison sorting, can be very accurately estimated using Stirling's approximation. In the formula below, the $MATH$ term invokes big O notation.
Divisibility and digits
The product formula for the factorial implies that $MATH$ is divisible by all prime numbers that are at most $MATH$, and by no larger prime numbers. More precise information about its divisibility is given by Legendre's formula, which gives the exponent of each prime $MATH$ in the prime factorization of $MATH$ as
Here $MATH$ denotes the sum of the base-$MATH$ digits of $MATH$, and the exponent given by this formula can also be interpreted in advanced mathematics as the p-adic valuation of the factorial. Applying Legendre's formula to the product formula for binomial coefficients produces Kummer's theorem, a similar result on the exponent of each prime in the factorization of a binomial coefficient. Grouping the prime factors of the factorial into prime powers in different ways produces the multiplicative partitions of factorials.
The special case of Legendre's formula for $MATH$ gives the number of trailing zeros in the decimal representation of the factorials. According to this formula, the number of zeros can be obtained by subtracting the base-5 digits of $MATH$ from $MATH$, and dividing the result by four. Legendre's formula implies that the exponent of the prime $MATH$ is always larger than the exponent for $MATH$, so each factor of five can be paired with a factor of two to produce one of these trailing zeros. The leading digits of the factorials are distributed according to Benford's law. Every sequence of digits, in any base, is the sequence of initial digits of some factorial number in that base.
Another result on divisibility of factorials, Wilson's theorem, states that $MATH$ is divisible by $MATH$ if and only if $MATH$ is a prime number. For any given integer $MATH$, the Kempner function of $MATH$ is given by the smallest $MATH$ for which $MATH$ divides $MATH$. For almost all numbers (all but a subset of exceptions with asymptotic density zero), it coincides with the largest prime factor of $MATH$.
The product of two factorials, $MATH$, always evenly divides $MATH$. There are infinitely many factorials that equal the product of other factorials: if $MATH$ is itself any product of factorials, then $MATH$ equals that same product multiplied by one more factorial, $MATH$. The only known examples of factorials that are products of other factorials but are not of this "trivial" form are $MATH$, $MATH$, and $MATH$. It would follow from the abc conjecture that there are only finitely many nontrivial examples.
The greatest common divisor of the values of a primitive polynomial of degree $MATH$ over the integers evenly divides $MATH$.
Continuous interpolation and non-integer generalization
There are infinitely many ways to extend the factorials to a continuous function. The most widely used of these uses the gamma function, which can be defined for positive real numbers as the integral
The resulting function is related to the factorial of a non-negative integer $MATH$ by the equation
which can be used as a definition of the factorial for non-integer arguments.
At all values $MATH$ for which both $MATH$ and $MATH$ are defined, the gamma function obeys the functional equation
generalizing the recurrence relation for the factorials.
The same integral converges more generally for any complex number $MATH$ whose real part is positive. It can be extended to the non-integer points in the rest of the complex plane by solving for Euler's reflection formula
However, this formula cannot be used at integers because, for them, the $MATH$ term would produce a division by zero. The result of this extension process is an analytic function, the analytic continuation of the integral formula for the gamma function. It has a nonzero value at all complex numbers, except for the non-positive integers where it has simple poles. Correspondingly, this provides a definition for the factorial at all complex numbers other than the negative integers.
One property of the gamma function, distinguishing it from other continuous interpolations of the factorials, is given by the Bohr–Mollerup theorem, which states that the gamma function (offset by one) is the only log-convex function on the positive real numbers that interpolates the factorials and obeys the same functional equation. A related uniqueness theorem of Helmut Wielandt states that the complex gamma function and its scalar multiples are the only holomorphic functions on the positive complex half-plane that obey the functional equation and remain bounded for complex numbers with real part between 1 and 2.
Other complex functions that interpolate the factorial values include Hadamard's gamma function, which is an entire function over all the complex numbers, including the non-positive integers. In the p-adic numbers, it is not possible to continuously interpolate the factorial function directly, because the factorials of large integers (a dense subset of the p-adics) converge to zero according to Legendre's formula, forcing any continuous function that is close to their values to be zero everywhere. Instead, the p-adic gamma function provides a continuous interpolation of a modified form of the factorial, omitting the factors in the factorial that are divisible by p.
The digamma function is the logarithmic derivative of the gamma function. Just as the gamma function provides a continuous interpolation of the factorials, offset by one, the digamma function provides a continuous interpolation of the harmonic numbers, offset by the Euler–Mascheroni constant.
Computation
The factorial function is a common feature in scientific calculators. It is also included in scientific programming libraries such as the Python mathematical functions module and the Boost C++ library. If efficiency is not a concern, computing factorials is trivial: just successively multiply a variable initialized to $MATH$ by the integers up to $MATH$. The simplicity of this computation makes it a common example in the use of different computer programming styles and methods.
The computation of $MATH$ can be expressed in pseudocode using iteration as
or using recursion based on its recurrence relation as
Other methods suitable for its computation include memoization, dynamic programming, and functional programming. The computational complexity of these algorithms may be analyzed using the unit-cost random-access machine model of computation, in which each arithmetic operation takes constant time and each number uses a constant amount of storage space. In this model, these methods can compute $MATH$ in time $MATH$, and the iterative version uses space $MATH$. Unless optimized for tail recursion, the recursive version takes linear space to store its call stack. However, this model of computation is only suitable when $MATH$ is small enough to allow $MATH$ to fit into a machine word. The values 12! and 20! are the largest factorials that can be stored in, respectively, the 32-bit and 64-bit integers. Floating point can represent larger factorials, but approximately rather than exactly, and will still overflow for factorials larger than $MATH$.
The exact computation of larger factorials involves arbitrary-precision arithmetic, because of fast growth and integer overflow.  Time of computation can be analyzed as a function of the number of digits or bits in the result. By Stirling's formula, $MATH$ has $MATH$ bits. The Schönhage–Strassen algorithm can produce a $MATH$-bit product in time $MATH$, and faster multiplication algorithms taking time $MATH$ are known. However, computing the factorial involves repeated products, rather than a single multiplication, so these time bounds do not apply directly.  In this setting, computing $MATH$ by multiplying the numbers from 1 to $MATH$ in sequence is inefficient, because it involves $MATH$ multiplications, a constant fraction of which take time $MATH$ each, giving total time $MATH$. A better approach is to perform the multiplications as a divide-and-conquer algorithm that multiplies a sequence of $MATH$ numbers by splitting it into two subsequences of $MATH$ numbers, multiplies each subsequence, and combines the results with one last multiplication. This approach to the factorial takes total time $MATH$: one logarithm comes from the number of bits in the factorial, a second comes from the multiplication algorithm, and a third comes from the divide and conquer.
Even better efficiency is obtained by computing n! from its prime factorization, based on the principle that exponentiation by squaring is faster than expanding an exponent into a product. An algorithm for this by Arnold Schönhage begins by finding the list of the primes up to $MATH$, for instance using the sieve of Eratosthenes, and uses Legendre's formula to compute the exponent for each prime. Then it computes the product of the prime powers with these exponents, using a recursive algorithm, as follows:
The product of all primes up to $MATH$ is an $MATH$-bit number, by the prime number theorem, so the time for the first step is $MATH$, with one logarithm coming from the divide and conquer and another coming from the multiplication algorithm. In the recursive calls to the algorithm, the prime number theorem can again be invoked to prove that the numbers of bits in the corresponding products decrease by a constant factor at each level of recursion, so the total time for these steps at all levels of recursion adds in a geometric series to $MATH$. The time for the squaring in the second step and the multiplication in the third step are again $MATH$, because each is a single multiplication of a number with $MATH$ bits. Again, at each level of recursion the numbers involved have a constant fraction as many bits (because otherwise repeatedly squaring them would produce too large a final result) so again the amounts of time for these steps in the recursive calls add in a geometric series to $MATH$. Consequentially, the whole algorithm takes time $MATH$, proportional to a single multiplication with the same number of bits in its result.
Related sequences and functions
Several other integer sequences are similar to or related to the factorials: