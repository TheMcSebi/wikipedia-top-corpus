Cavendish experiment
The Cavendish experiment, performed in 1797–1798 by English scientist Henry Cavendish, was the first experiment to measure the force of gravity between masses in the laboratory and the first to yield accurate values for the gravitational constant. Because of the unit conventions then in use, the gravitational constant does not appear explicitly in Cavendish's work. Instead, the result was originally expressed as the specific gravity of Earth, or equivalently the mass of Earth. His experiment gave the first accurate values for these geophysical constants.
The experiment was devised sometime before 1783 by geologist John Michell, who constructed a torsion balance apparatus for it. However, Michell died in 1793 without completing the work. After his death the apparatus passed to Francis John Hyde Wollaston and then to Cavendish, who rebuilt the apparatus but kept close to Michell's original plan. Cavendish then carried out a series of measurements with the equipment and reported his results in the Philosophical Transactions of the Royal Society in 1798.
The experiment
The apparatus consisted of a torsion balance made of a six-foot (1.8 m) wooden rod horizontally suspended from a wire, with two 2-inch-diameter (51 mm), 1.61-pound (0.73 kg) lead spheres, one attached to each end. Two massive 12-inch (300 mm), 348-pound (158 kg) lead balls, suspended separately, could be positioned away from or to either side of the smaller balls, 8.85 inches (225 mm) away.  The experiment measured the faint gravitational attraction between the small and large balls, which deflected the torsion balance rod by about 0.16" (or only 0.03" with a stiffer suspending wire).
The two large balls could be positioned either away from or to either side of the torsion balance rod. Their mutual attraction to the small balls caused the arm to rotate, twisting the suspension wire. The arm rotated until it reached an angle where the twisting force of the wire balanced the combined gravitational force of attraction between the large and small lead spheres. By measuring the angle of the rod and knowing the twisting force (torque) of the wire for a given angle, Cavendish was able to determine the force between the pairs of masses. Since the gravitational force of the Earth on the small ball could be measured directly by weighing it, the ratio of the two forces allowed the specific gravity of the Earth to be calculated, using Newton's law of gravitation.
Cavendish found that the Earth's density was 5.448±0.033 times that of water (due to a simple arithmetic error, found in 1821 by Francis Baily, the erroneous value 5.480±0.038 appears in his paper). The current accepted value is 5.514 g/cm3.  
To find the wire's torsion coefficient, the torque exerted by the wire for a given angle of twist, Cavendish timed the natural oscillation period of the balance rod as it rotated slowly clockwise and counterclockwise against the twisting of the wire. For the first 3 experiments the period was about 15 minutes and for the next 14 experiments the period was half of that, about 7.5 minutes. The period changed because after the third experiment Cavendish put a stiffer wire. The torsion coefficient could be calculated from this and the mass and dimensions of the balance. Actually, the rod was never at rest; Cavendish had to measure the deflection angle of the rod while it was oscillating.
Cavendish's equipment was remarkably sensitive for its time. The force involved in twisting the torsion balance was very small, 1.74×10−7 N, (the weight of only 0.0177 milligrams) or about 1⁄50,000,000 of the weight of the small balls. To prevent air currents and temperature changes from interfering with the measurements, Cavendish placed the entire apparatus in a mahogany box about 1.98 meters wide, 1.27 meters tall, and 14 cm thick, all in a closed shed on his estate. Through two holes in the walls of the shed, Cavendish used telescopes to observe the movement of the torsion balance's horizontal rod. The key observable was of course the deflection of the torsion balance rod, which Cavendish measured to be about 0.16" (or only 0.03" for the stiffer wire used mostly).  Cavendish was able to measure this small deflection to an accuracy of better than 0.01 inches (0.25 mm) using vernier scales on the ends of the rod.
The accuracy of Cavendish's result was not exceeded until C. V. Boys' experiment in 1895. In time, Michell's torsion balance became the dominant technique for measuring the gravitational constant (G) and most contemporary measurements still use variations of it.
Cavendish's result provided additional evidence for a planetary core made of metal, an idea first proposed by Charles Hutton based on his analysis of the 1774 Schiehallion experiment. Cavendish's result of 5.4 g·cm−3, 23% bigger than Hutton's, is close to 80% of the density of liquid iron, and 80% higher than the density of the Earth's outer crust, suggesting the existence of a dense iron core.
Whether Cavendish determined G
The formulation of Newtonian gravity in terms of a gravitational constant did not become standard until long after Cavendish's time. Indeed, one of the first references to G is in 1873, 75 years after Cavendish's work.
Cavendish expressed his result in terms of the density of the Earth. For this reason, historians of science have argued that Cavendish did not measure the gravitational constant. He referred to his experiment in correspondence as 'weighing the world'. Later authors reformulated his results in modern terms.
After converting to SI units, Cavendish's value for the Earth's density, 5.448 g cm−3, gives
which differs by only 1% from the 2014 CODATA value of 6.67408×10−11 m3 kg−1 s−2.
Today, physicists often use units where the gravitational constant takes a different form. The Gaussian gravitational constant used in space dynamics is a defined constant and the Cavendish experiment can be considered as a measurement of this constant.
In Cavendish's time, physicists used the same units for mass and weight, in effect taking g as a standard acceleration. Then, since Rearth was known, ρearth played the role of an inverse gravitational constant. The density of the Earth was hence a much sought-after quantity at the time, and there had been earlier attempts to measure it, such as the Schiehallion experiment in 1774.
For these reasons, physicists generally do credit Cavendish with the first measurement of the gravitational constant.
Derivation of G and the Earth's mass
The following is not the method Cavendish used, but describes how modern physicists would calculate the results from his experiment. From Hooke's law, the torque on the torsion wire is proportional to the deflection angle $MATH$ of the balance. The torque is $MATH$ where $MATH$ is the torsion coefficient of the wire. However, a torque in opposite direction is also generated by the gravitational pull of the masses. It can be written as a product of the attractive forces between the balls and the distance to the suspension wire. Since there are two pairs of balls, each experiencing force F at a distance L/2 from the axis of the balance, the torque is LF. At equilibrium (when the balance has been stabilized at an angle $MATH$), the total amount of torque must be zero, as these two sources of torque cancel out. Thus, we can equate their intensities given by the formulas above, which gives the following:
For F, Newton's law of universal gravitation is used to express the attractive force between the large and small balls:




Substituting F into the first equation above gives
To find the torsion coefficient ($MATH$) of the wire, Cavendish measured the natural resonant oscillation period T of the torsion balance:
Assuming the mass of the torsion beam itself is negligible, the moment of inertia of the balance is just due to the small balls:
and so:
Solving this for $MATH$, substituting into (1), and rearranging for G, the result is:
Once G has been found, the attraction of an object at the Earth's surface to the Earth itself can be used to calculate the Earth's mass and density: