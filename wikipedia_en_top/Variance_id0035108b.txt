Variance
In probability theory and statistics, variance is the expectation of the squared deviation of a random variable from its population mean or sample mean. Variance is a measure of dispersion, meaning it is a measure of how far a set of numbers is spread out from their average value. Variance has a central role in statistics, where some ideas that use it include descriptive statistics, statistical inference, hypothesis testing, goodness of fit, and Monte Carlo sampling. Variance is an important tool in the sciences, where statistical analysis of data is common. The variance is the square of the standard deviation, the second central moment of a distribution, and the covariance of the random variable with itself, and it is often represented by $MATH$, $MATH$, $MATH$, $MATH$, or $MATH$.
An advantage of variance as a measure of dispersion is that it is more amenable to algebraic manipulation than other measures of dispersion such as the expected absolute deviation; for example, the variance of a sum of uncorrelated random variables is equal to the sum of their variances. A disadvantage of the variance for practical applications is that, unlike the standard deviation, its units differ from the random variable, which is why the standard deviation is more commonly reported as a measure of dispersion once the calculation is finished.
There are two distinct concepts that are both called "variance". One, as discussed above, is part of a theoretical probability distribution and is defined by an equation. The other variance is a characteristic of a set of observations. When variance is calculated from observations, those observations are typically measured from a real world system. If all possible observations of the system are present then the calculated variance is called the population variance. Normally, however, only a subset is available, and the variance calculated from this is called the sample variance. The variance calculated from a sample is considered an estimate of the full population variance. There are multiple ways to calculate an estimate of the population variance, as discussed in the section below.
The two kinds of variance are closely related. To see how, consider that a theoretical probability distribution can be used as a generator of hypothetical observations. If an infinite number of observations are generated using a distribution, then the sample variance calculated from that infinite set will match the value calculated using the distribution's equation for variance.
Etymology
The term variance was first introduced by Ronald Fisher in his 1918 paper The Correlation Between Relatives on the Supposition of Mendelian Inheritance:
Definition
The variance of a random variable $MATH$ is the expected value of the squared deviation from the mean of $MATH$, $MATH$:
This definition encompasses random variables that are generated by processes that are discrete, continuous, neither, or mixed. The variance can also be thought of as the covariance of a random variable with itself:
The variance is also equivalent to the second cumulant of a probability distribution that generates $MATH$. The variance is typically designated as $MATH$, or sometimes as $MATH$ or $MATH$, or symbolically as $MATH$ or simply $MATH$ (pronounced "sigma squared"). The expression for the variance can be expanded as follows:
In other words, the variance of X is equal to the mean of the square of X minus the square of the mean of X.  This equation should not be used for computations using floating point arithmetic, because it suffers from catastrophic cancellation if the two components of the equation are similar in magnitude. For other numerically stable alternatives, see Algorithms for calculating variance.
Discrete random variable
If the generator of random variable $MATH$ is discrete with probability mass function $MATH$, then
where $MATH$ is the expected value. That is,
(When such a discrete weighted variance is specified by weights whose sum is not 1, then one divides by the sum of the weights.)
The variance of a collection of $MATH$ equally likely values can be written as
where $MATH$ is the average value. That is,
The variance of a set of $MATH$ equally likely values can be equivalently expressed, without directly referring to the mean, in terms of squared deviations of all pairwise squared distances of points from each other:
Absolutely continuous random variable
If the random variable $MATH$ has a probability density function $MATH$, and $MATH$ is the corresponding cumulative distribution function, then
or equivalently,
where $MATH$ is the expected value of $MATH$ given by
In these formulas, the integrals with respect to $MATH$ and $MATH$
are Lebesgue and Lebesgue–Stieltjes integrals, respectively.
If the function $MATH$ is Riemann-integrable on every finite interval $MATH$ then
where the integral is an improper Riemann integral.
Examples
Exponential distribution
The exponential distribution with parameter λ is a continuous distribution whose probability density function is given by
on the interval [0, ∞).  Its mean can be shown to be
Using integration by parts and making use of the expected value already calculated, we have:
Thus, the variance of X is given by
Fair die
A fair six-sided die can be modeled as a discrete random variable, X, with outcomes 1 through 6, each with equal probability 1/6.  The expected value of X is $MATH$ Therefore, the variance of X is
The general formula for the variance of the outcome, X, of an n-sided die is
Commonly used probability distributions
The following table lists the variance for some commonly used probability distributions.
Properties
Basic properties
Variance is non-negative because the squares are positive or zero:
The variance of a constant is zero.
Conversely, if the variance of a random variable is 0, then it is almost surely a constant. That is, it always has the same value:
Issues of finiteness
If a distribution does not have a finite expected value, as is the case for the Cauchy distribution, then the variance cannot be finite either. However, some distributions may not have a finite variance, despite their expected value being finite. An example is a Pareto distribution whose index $MATH$ satisfies $MATH$
Decomposition
The general formula for variance decomposition or the law of total variance is: If $MATH$ and $MATH$ are two random variables, and the variance of $MATH$ exists, then
The conditional expectation $MATH$ of $MATH$ given $MATH$, and the conditional variance $MATH$ may be understood as follows. Given any particular value y of the random variable Y, there is a conditional expectation $MATH$  given the event Y = y. This quantity depends on the particular value y; it is a function $MATH$. That same function evaluated at the random variable Y is the conditional expectation $MATH$
In particular, if $MATH$ is a discrete random variable assuming possible values $MATH$ with corresponding probabilities $MATH$, then in the formula for total variance, the first term on the right-hand side becomes
where $MATH$. Similarly, the second term on the right-hand side becomes
where $MATH$ and $MATH$. Thus the total variance is given by
A similar formula is applied in analysis of variance, where the corresponding formula is
here $MATH$ refers to the Mean of the Squares. In linear regression analysis the corresponding formula is
This can also be derived from the additivity of variances, since the total (observed) score is the sum of the predicted score and the error score, where the latter two are uncorrelated.
Similar decompositions are possible for the sum of squared deviations (sum of squares, $MATH$):
Calculation from the CDF
The population variance for a non-negative random variable can be expressed in terms of the cumulative distribution function F using
This expression can be used to calculate the variance in situations where the CDF, but not the density, can be conveniently expressed.
Characteristic property
The second moment of a random variable attains the minimum value when taken around the first moment (i.e., mean) of the random variable, i.e. $MATH$. Conversely, if a continuous function $MATH$ satisfies $MATH$ for all random variables X, then it is necessarily of the form $MATH$, where a > 0. This also holds in the multidimensional case.
Units of measurement
Unlike the expected absolute deviation, the variance of a variable has units that are the square of the units of the variable itself.  For example, a variable measured in meters will have a variance measured in meters squared.  For this reason, describing data sets via their standard deviation or root mean square deviation is often preferred over using the variance.  In the dice example the standard deviation is √2.9 ≈ 1.7, slightly larger than the expected absolute deviation of 1.5.
The standard deviation and the expected absolute deviation can both be used as an indicator of the "spread" of a distribution.  The standard deviation is more amenable to algebraic manipulation than the expected absolute deviation, and, together with variance and its generalization covariance, is used frequently in theoretical statistics; however the expected absolute deviation tends to be more robust as it is less sensitive to outliers arising from measurement anomalies or an unduly heavy-tailed distribution.
Propagation
Addition and multiplication by a constant
Variance is invariant with respect to changes in a location parameter.  That is, if a constant is added to all values of the variable, the variance is unchanged:
If all values are scaled by a constant, the variance is scaled by the square of that constant:
The variance of a sum of two random variables is given by
where $MATH$ is the covariance.
Linear combinations
In general, for the sum of $MATH$ random variables $MATH$, the variance becomes:
see also general Bienaymé's identity.
These results lead to the variance of a linear combination as:
If the random variables $MATH$ are such that
then they are said to be uncorrelated. It follows immediately from the expression given earlier that if the random variables $MATH$ are uncorrelated, then the variance of their sum is equal to the sum of their variances, or, expressed symbolically:
Since independent random variables are always uncorrelated (see Covariance § Uncorrelatedness and independence), the equation above holds in particular when the random variables $MATH$ are independent.  Thus, independence is sufficient but not necessary for the variance of the sum to equal the sum of the variances.
Matrix notation for the variance of a linear combination
Define $MATH$ as a column vector of $MATH$ random variables $MATH$, and $MATH$ as a column vector of $MATH$ scalars $MATH$. Therefore, $MATH$ is a linear combination of these random variables, where $MATH$ denotes the transpose of $MATH$. Also let $MATH$ be the covariance matrix of $MATH$. The variance of $MATH$ is then given by:
This implies that the variance of the mean can be written as (with a column vector of ones)
Sum of uncorrelated variables
One reason for the use of the variance in preference to other measures of dispersion is that the variance of the sum (or the difference) of uncorrelated random variables is the sum of their variances:
This statement is called the Bienaymé formula and was discovered in 1853. It is often made with the stronger condition that the variables are independent, but being uncorrelated suffices. So if all the variables have the same variance σ2, then, since division by n is a linear transformation, this formula immediately implies that the variance of their mean is
That is, the variance of the mean decreases when n increases. This formula for the variance of the mean is used in the definition of the standard error of the sample mean, which is used in the central limit theorem.
To prove the initial statement, it suffices to show that
The general result then follows by induction.  Starting with the definition,
Using the linearity of the expectation operator and the assumption of independence (or uncorrelatedness) of X and Y, this further simplifies as follows:
Sum of correlated variables with fixed sample size
In general, the variance of the sum of n variables is the sum of their covariances:
(Note: The second equality comes from the fact that Cov(Xi,Xi) = Var(Xi).)
Here, $MATH$ is the covariance, which is zero for independent random variables (if it exists). The formula states that the variance of a sum is equal to the sum of all elements in the covariance matrix of the components. The next expression states equivalently that the variance of the sum is the sum of the diagonal of covariance matrix plus two times the sum of its upper triangular elements (or its lower triangular elements); this emphasizes that the covariance matrix is symmetric. This formula is used in the theory of Cronbach's alpha in classical test theory.
So if the variables have equal variance σ2 and the average correlation of distinct variables is ρ, then the variance of their mean is
This implies that the variance of the mean increases with the average of the correlations. In other words, additional correlated observations are not as effective as additional independent observations at reducing the uncertainty of the mean. Moreover, if the variables have unit variance, for example if they are standardized, then this simplifies to
This formula is used in the Spearman–Brown prediction formula of classical test theory. This converges to ρ if n goes to infinity, provided that the average correlation remains constant or converges too. So for the variance of the mean of standardized variables with equal correlations or converging average correlation we have
Therefore, the variance of the mean of a large number of standardized variables is approximately equal to their average correlation. This makes clear that the sample mean of correlated variables does not generally converge to the population mean, even though the law of large numbers states that the sample mean will converge for independent variables.
Sum of uncorrelated variables with random sample size
There are cases when a sample is taken without knowing, in advance, how many observations will be acceptable according to some criterion. In such cases, the sample size N is a random variable whose variation adds to the variation of X, such that,
which follows from the law of total variance.
If N has a Poisson distribution, then $MATH$ with estimator N = n. So, the estimator of $MATH$ becomes $MATH$ giving $MATH$
Weighted sum of variables
The scaling property and the Bienaymé formula, along with the property of the covariance Cov(aX, bY) = ab Cov(X, Y)  jointly imply that
This implies that in a weighted sum of variables, the variable with the largest weight will have a disproportionally large weight in the variance of the total. For example, if X and Y are uncorrelated and the weight of X is two times the weight of Y, then the weight of the variance of X will be four times the weight of the variance of Y.
The expression above can be extended to a weighted sum of multiple variables:
Product of independent variables
If two variables X and Y are independent, the variance of their product is given by
Equivalently, using the basic properties of expectation, it is given by
Product of statistically dependent variables
In general, if two variables are statistically dependent, then the variance of their product is given by:
Arbitrary functions
The delta method uses second-order Taylor expansions to approximate the variance of a function of one or more random variables: see Taylor expansions for the moments of functions of random variables. For example, the approximate variance of a function of one variable is given by
provided that f is twice differentiable and that the mean and variance of X are finite.
Population variance and sample variance
Real-world observations such as the measurements of yesterday's rain throughout the day typically cannot be complete sets of all possible observations that could be made. As such, the variance calculated from the finite set will in general not match the variance that would have been calculated from the full population of possible observations.  This means that one estimates the mean and variance from a limited set of observations by using an estimator equation.  The estimator is a function of the sample of n observations drawn without observational bias from the whole population of potential observations. In this example that sample would be the set of actual measurements of yesterday's rainfall from available rain gauges within the geography of interest.
The simplest estimators for population mean and population variance are simply the mean and variance of the sample, the sample mean and (uncorrected) sample variance – these are consistent estimators (they converge to the correct value as the number of samples increases), but can be improved. Estimating the population variance by taking the sample's variance is close to optimal in general, but can be improved in two  ways. Most simply, the sample variance is computed as an average of squared deviations about the (sample) mean, by dividing by n. However, using values other than n improves the estimator in various ways. Four common values for the denominator are n, n − 1, n + 1, and n − 1.5: n is the simplest (population variance of the sample), n − 1 eliminates bias, n + 1 minimizes mean squared error for the normal distribution, and n − 1.5 mostly eliminates bias in unbiased estimation of standard deviation for the normal distribution.
Firstly, if the true population mean is unknown, then the sample variance (which uses the sample mean in place of the true mean) is a biased estimator: it underestimates the variance by a factor of (n − 1) / n; correcting by this factor (dividing by n − 1 instead of n) is called Bessel's correction. The resulting estimator is unbiased, and is called the (corrected) sample variance or unbiased sample variance. For example, when n = 1 the variance of a single observation about the sample mean (itself) is obviously zero regardless of the population variance. If the mean is determined in some other way than from the same samples used to estimate the variance then this bias does not arise and the variance can safely be estimated as that of the samples about the (independently known) mean.
Secondly, the sample variance does not generally minimize mean squared error between sample variance and population variance. Correcting for bias often makes this worse: one can always choose a scale factor that performs better than the corrected sample variance, though the optimal scale factor depends on the excess kurtosis of the population (see mean squared error: variance), and introduces bias. This always consists of scaling down the unbiased estimator (dividing by a number larger than n − 1), and is a simple example of a shrinkage estimator: one "shrinks" the unbiased estimator towards zero. For the normal distribution, dividing by n + 1 (instead of n − 1 or n) minimizes mean squared error. The resulting estimator is biased, however, and is known as the biased sample variation.
Population variance
In general, the population variance of a finite population of size N with values xi is given by
where the population mean is
The population variance can also be computed using
This is true because
The population variance matches the variance of the generating probability distribution. In this sense, the concept of population can be extended to continuous random variables with infinite populations.
Biased sample variance
In many practical situations, the true variance of a population is not known a priori and must be computed somehow.  When dealing with extremely large populations, it is not possible to count every object in the population, so the computation must be performed on a sample of the population. Sample variance can also be applied to the estimation of the variance of a continuous distribution from a sample of that distribution.
We take a  sample with replacement of n values Y1, ..., Yn from the population, where n < N, and estimate the variance on the basis of this sample. Directly taking the variance of the sample data gives the average of the squared deviations:
Here, $MATH$ denotes the sample mean: 
Since the Yi are selected randomly, both $MATH$ and $MATH$ are random variables. Their expected values can be evaluated by averaging over the ensemble of all possible samples {Yi} of size n from the population. For $MATH$ this gives:
Hence $MATH$ gives an estimate of the population variance that is biased by a factor of $MATH$. For this reason, $MATH$ is referred to as the biased sample variance.
Unbiased sample variance
Correcting for this bias yields the unbiased sample variance, denoted $MATH$:
Either estimator may be simply referred to as the sample variance when the version can be determined by context. The same proof is also applicable for samples taken from a continuous probability distribution.
The use of the term n − 1 is called Bessel's correction, and it is also used in sample covariance and the sample standard deviation (the square root of variance). The square root is a concave function and thus introduces negative bias (by Jensen's inequality), which depends on the distribution, and thus the corrected sample standard deviation (using Bessel's correction) is biased. The unbiased estimation of standard deviation is a technically involved problem, though for the normal distribution using the term n − 1.5 yields an almost unbiased estimator.
The unbiased sample variance is a U-statistic for the function ƒ(y1, y2) = (y1 − y2)2/2, meaning that it is obtained by averaging a 2-sample statistic over 2-element subsets of the population.
Distribution of the sample variance
Being a function of random variables, the sample variance is itself a random variable, and it is natural to study its distribution. In the case that Yi are independent observations from a normal distribution, Cochran's theorem shows that S2 follows a scaled chi-squared distribution (see also: asymptotic properties):
As a direct consequence, it follows that 
and
If the Yi are independent and identically distributed, but not necessarily normally distributed, then
where κ is the kurtosis of the distribution and μ4 is the fourth central moment.
If the conditions of the law of large numbers hold for the squared observations, S2 is a consistent estimator of σ2. One can see indeed that the variance of the estimator tends asymptotically to zero.  An asymptotically equivalent formula was given in Kenney and Keeping (1951:164), Rose and Smith (2002:264), and Weisstein (n.d.).
Samuelson's inequality
Samuelson's inequality is a result that states bounds on the values that individual observations in a sample can take, given that the sample mean and (biased) variance have been calculated. Values must lie within the limits $MATH$
Relations with the harmonic and arithmetic means
It has been shown that for a sample {yi} of positive real numbers,
where ymax is the maximum of the sample, A is the arithmetic mean, H is the harmonic mean of the sample and $MATH$ is the (biased) variance of the sample.
This bound has been improved, and it is known that variance is bounded by
where ymin is the minimum of the sample.
Tests of equality of variances
The F-test of equality of variances and the chi square tests are adequate when the sample is normally distributed. Non-normality makes testing for the equality of two or more variances more difficult. 
Several non parametric tests have been proposed: these include the Barton–David–Ansari–Freund–Siegel–Tukey test, the Capon test, Mood test, the Klotz test and the Sukhatme test. The Sukhatme test applies to two variances and requires that both medians be known and equal to zero. The Mood, Klotz, Capon and Barton–David–Ansari–Freund–Siegel–Tukey tests also apply to two variances. They allow the median to be unknown but do require that the two medians are equal.
The Lehmann test is a parametric test of two variances. Of this test there are several variants known. Other tests of the equality of variances include the Box test, the Box–Anderson test and the Moses test.
Resampling methods, which include the bootstrap and the jackknife, may be used to test the equality of variances.
Moment of inertia
The variance of a probability distribution is analogous to the  moment of inertia in classical mechanics of a corresponding mass distribution along a line, with respect to rotation about its center of mass.  It is because of this analogy that such things as the variance are called moments of probability distributions. The covariance matrix is related to the moment of inertia tensor for multivariate distributions. The moment of inertia of a cloud of n points with a covariance matrix of $MATH$ is given by
This difference between moment of inertia in physics and in statistics is clear for points that are gathered along a line. Suppose many points are close to the x axis and distributed along it. The covariance matrix might look like
That is, there is the most variance in the x direction.  Physicists would consider this to have a low moment about the x axis so the moment-of-inertia tensor is
Semivariance


The semivariance is calculated in the same manner as the variance but only those observations that fall below the mean are included in the calculation:
It is also described as a specific measure in different fields of application. For skewed distributions, the semivariance can provide additional information that a variance does not.
For inequalities associated with the semivariance, see Chebyshev's inequality § Semivariances.
Generalizations
For complex variables
If $MATH$ is a scalar complex-valued random variable, with values in $MATH$ then its variance is $MATH$ where $MATH$ is the complex conjugate of $MATH$  This variance is a real scalar.
As a matrix
If $MATH$ is a vector-valued random variable, with values in $MATH$ and thought of as a column vector, then a natural generalization of variance is $MATH$ where $MATH$ and $MATH$ is the transpose of $MATH$ and so is a row vector.  The result is a positive semi-definite square matrix, commonly referred to as the variance-covariance matrix (or simply as the covariance matrix).
If $MATH$ is a vector- and complex-valued random variable, with values in $MATH$ then the covariance matrix is $MATH$ where $MATH$ is the conjugate transpose of $MATH$  This matrix is also positive semi-definite and square.
As a scalar
Another generalization of variance for vector-valued random variables $MATH$, which results in a scalar value rather than in a matrix, is the generalized variance $MATH$, the determinant of the covariance matrix. The generalized variance can be shown to be related to the multidimensional scatter of points around their mean.
A different generalization is obtained by considering the Euclidean distance between the random variable and its mean. This results in $MATH$ which is the trace of the covariance matrix.