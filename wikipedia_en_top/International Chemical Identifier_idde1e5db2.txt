International Chemical Identifier
The International Chemical Identifier (InChI /ˈɪntʃiː/ IN-chee or /ˈɪŋkiː/ ING-kee) is a textual identifier for chemical substances, designed to provide a standard way to encode molecular information and to facilitate the search for such information in databases and on the web. Initially developed by the International Union of Pure and Applied Chemistry (IUPAC) and National Institute of Standards and Technology (NIST) from 2000 to 2005, the format and algorithms are non-proprietary. Since May 2009, it has been developed by the InChI Trust, a nonprofit charity from the United Kingdom which works to implement and promote the use of InChI.
The identifiers describe chemical substances in terms of layers of information — the atoms and their bond connectivity, tautomeric information, isotope information, stereochemistry, and electronic charge information.
Not all layers have to be provided; for instance, the tautomer layer can be omitted if that type of information is not relevant to the particular application. The InChI algorithm converts input structural information into a unique InChI identifier in a three-step process: normalization (to remove redundant information), canonicalization (to generate a unique number label for each atom), and serialization (to give a string of characters).
InChIs differ from the widely used CAS registry numbers in three respects: firstly, they are freely usable and non-proprietary; secondly, they can be computed from structural information and do not have to be assigned by some organization; and thirdly, most of the information in an InChI is human readable (with practice). InChIs can thus be seen as akin to a general and extremely formalized version of IUPAC names. They can express more information than the simpler SMILES notation and differ in that every structure has a unique InChI string, which is important in database applications. Information about the 3-dimensional coordinates of atoms is not represented in InChI; for this purpose a format such as PDB can be used.
The InChIKey, sometimes referred to as a hashed InChI, is a fixed length (27 character) condensed digital representation of the InChI that is not human-understandable.  The InChIKey specification was released in September 2007 in order to facilitate web searches for chemical compounds, since these were problematic with the full-length InChI. Unlike the InChI, the InChIKey is not unique: though collisions can be calculated to be very rare, they happen.
In January 2009 the 1.02 version of the InChI software was released. This provided a means to generate so called standard InChI, which does not allow for user selectable options in dealing with the stereochemistry and tautomeric layers of the InChI string. The standard InChIKey is then the hashed version of the standard InChI string. The standard InChI will simplify comparison of InChI strings and keys generated by different groups, and subsequently accessed via diverse sources such as databases and web resources.
The continuing development of the standard has been supported since 2010 by the not-for-profit InChI Trust, of which IUPAC is a member. The current software version is 1.06 and was released in December 2020.  Prior to 1.04, the software was freely available under the open-source LGPL license,
but it now uses a custom license called IUPAC-InChI Trust License.
Generation
In order to avoid generating different InChIs for tautomeric structures, before generating the
InChI, an input chemical structure is normalized to reduce it to its so-called core parent structure.
This may involve changing bond orders, rearranging formal charges and possibly adding
and removing protons.  Different input structures may give the same result; for example,
acetic acid and acetate would both give the same core parent structure, that of acetic
acid.  A core parent structure may be disconnected, consisting of more than one component,
in which case the
sublayers in the InChI usually consist of sublayers for each component, separated by semicolons
(periods for the chemical formula sublayer.)  One way this can happen is that all
metal atoms are disconnected during normalization; so, for example, the InChI for tetraethyllead
will have five components, one for lead and four for the ethyl groups.
The first, main, layer of the InChI refers to this core parent structure, giving its
chemical formula, non-hydrogen connectivity without bond order (/c sublayer) and
hydrogen connectivity (/h sublayer.)  The /q portion of
the charge layer gives its charge, and the /p portion of the charge layer tells how many
protons (hydrogen ions) must be added to or removed from it to regenerate the original structure.
If present, the stereochemical layer, with sublayers /b, /t, /m and /s, gives stereochemical information, and
the isotopic layer
/i (which may contain sublayers /h, /b, /t, /m and /s) gives isotopic information.
These are the only layers which can occur in a standard InChI.
If the user wants to specify an exact tautomer, a fixed hydrogen layer /f can be appended, which may contain
various additional sublayers; this cannot be done in standard InChI though, so different tautomers will have
the same standard InChI (for example, alanine will give the same standard InChI whether input in a neutral or a zwitterionic form.)
Finally, a nonstandard reconnected /r layer can be added, which effectively gives a new InChI generated without
breaking bonds to metal atoms.  This may contain various sublayers, including /f.
Format and layers
Every InChI starts with the string "InChI=" followed by the version number, currently 1. If the InChI is standard, this is followed by the letter S for standard InChIs, which is a fully standardized InChI flavor maintaining the same level of attention to structure details and the same conventions for drawing perception. The remaining information is structured as a sequence of layers and sub-layers, with each layer providing one specific type of information. The layers and sub-layers are separated by the delimiter "/" and start with a characteristic prefix letter (except for the chemical formula sub-layer of the main layer). The six layers with important sublayers are:
The delimiter-prefix format has the advantage that a user can easily use a wildcard search to find identifiers that match only in certain layers.
InChIKey
The condensed, 27 character InChIKey is a hashed version of the full InChI (using the SHA-256 algorithm), designed to allow for easy web searches of chemical compounds. The standard InChIKey is the hashed counterpart of standard InChI. Most chemical structures on the Web up to 2007 have been represented as GIF files, which are not searchable for chemical content.  The full InChI turned out to be too lengthy for easy searching, and therefore the InChIKey was developed.  There is a very small, but nonzero chance of two different molecules having the same InChIKey, but the probability for duplication of only the first 14 characters has been estimated as only one duplication in 75 databases each containing one billion unique structures.  With all databases currently having below 50 million structures, such duplication appears unlikely at present. A recent study more extensively studies the collision rate finding that the experimental collision rate is in agreement with the theoretical expectations.
The InChIKey currently consists of three parts separated by hyphens, of 14, 10 and one character(s), respectively, like XXXXXXXXXXXXXX-YYYYYYYYFV-P. The first 14 characters result from a SHA-256 hash of the connectivity information (the main layer and /q sublayer of the charge layer) of the InChI. The second part consists of 8 characters resulting from a hash of the remaining layers of the InChI, a single character indicating the kind of InChIKey (S for standard and N for nonstandard), and a character indicating the version of InChI used (currently A for version 1.)
Finally, the single character at the end indicates the protonation of the core parent structure, corresponding to the /p sublayer of the charge layer (N for no protonation, O, P, ... if protons should be added and M, L, ... if they should be removed.)
Example
Morphine has the structure shown on the right. The standard InChI for morphine is       InChI=1S/C17H19NO3/c1-18-7-6-17-10-3-5-13(20)16(17)21-15-12(19)4-2-9(14(15)17)8-11(10)18/h2-5,10-11,13,16,19-20H,6-8H2,1H3/t10-,11+,13-,16-,17-/m0/s1
and the standard InChIKey for morphine is BQJCRHHNABKAKU-KBQPJGBKSA-N.
InChI resolvers
As the InChI cannot be reconstructed from the InChIKey, an InChIKey always needs to be linked to the original InChI to get back to the original structure. InChI Resolvers act as a lookup service to make these links, and prototype services are available from National Cancer Institute, the UniChem service at the European Bioinformatics Institute, and PubChem. ChemSpider has had a resolver until July 2015 when it was decommissioned.
Name
The format was originally called IChI (IUPAC Chemical Identifier), then renamed in July 2004 to INChI (IUPAC-NIST Chemical Identifier), and renamed again in November 2004 to InChI (IUPAC International Chemical Identifier), a trademark of IUPAC.
Continuing development
Scientific direction of the InChI standard is carried out by the IUPAC Division VIII Subcommittee, and funding of subgroups investigating and defining the expansion of the standard is carried out by both IUPAC and the InChI Trust. The InChI Trust funds the development, testing and documentation of the InChI. Current extensions are being defined to handle polymers and mixtures, Markush structures, reactions and organometallics, and once accepted by the Division VIII Subcommittee will be added to the algorithm.
Software
The InChI Trust has developed software to generate the InChI, InChIKey and other identifiers.  The release history of this software follows.
Adoption
The InChI has been adopted by many larger and smaller databases, including ChemSpider, ChEMBL, Golm Metabolome Database, OpenPHACTS, and PubChem. However, the adoption is not straightforward, and many databases show a discrepancy between the chemical structures and the InChI they contain, which is a problem for linking databases.
See also
Notes and references